# Описание проекта
## Условие задачи

Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

### Описание услуг

Оператор предоставляет два основных типа услуг: 

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны такие услуги:

- Интернет-безопасность: антивирус (*DeviceProtection*) и блокировка небезопасных сайтов (*OnlineSecurity*);
- Выделенная линия технической поддержки (*TechSupport*);
- Облачное хранилище файлов для резервного копирования данных (*OnlineBackup*);
- Стриминговое телевидение (*StreamingTV*) и каталог фильмов (*StreamingMovies*).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

### Описание данных

Данные состоят из файлов, полученных из разных источников:

- `contract.csv` — информация о договоре;
- `personal.csv` — персональные данные клиента;
- `internet.csv` — информация об интернет-услугах;
- `phone.csv` — информация об услугах телефонии.

Во всех файлах столбец `customerID` содержит код клиента.

Информация о договорах актуальна на 1 февраля 2020.

### Данные

[final_provider.zip]()

Целевой признак: столбец `'EndDate'` равен `'No'`.

Основная метрика: **AUC-ROC**.

Дополнительная метрика: **Accuracy**.

# Итоги

Лучший результат показывает модель `CatBoost` с настроенными гиперпараметрами. Требуемое значение `ROC-AUC=0.88` достигнуто с запасом (0.93). `Accuracy` для лучшей модели может составлять до 90.5%.

Выбор метрики ROC-AUC позволяет подобрать хорошую модель без привязки к пороговому значению отнесения к положительному или отрицательному классу целевого признака.

Что сделано:
- исследовательский анализ данных
- все данные объединены в один датасет
- добавлен признак (количество дней действия контракта)
- корреляционный анализ признаков + важность для базовой модели с помощь LOFO
- данные подготовлены для работы с моделями (приведение типов, кодирование)
- проверены следующие модели:
    - LogisticRegressionCV
    - lgb
    - RandomForestClassifier
    - CatBoostClassifier
    - Нейросетевая модель

# Отчет

### 1. Объединение данных - выполнено
Все представленные таблицы (файлы) были [объединены](#Объединение-данных). Т.к. в `internet` и `phone` было меньше записей, то получившиеся пропуски были [запонены](#Избавимся-от-пропусков). Для наглядности были построены [диаграммы Венна](#Диаграммы-Вена) для абонентов с подключенным интернетом и/или телефоном.

### 2. Исследование баланса классов, корреляции признаков, поиск инсайтов - выполнено
С помощью графиков был исследован [баланс классов](#Исследование-баланса-классов). Построена [корреляционная матрица](#Важность-признаков) и определены мультиколлениарные признаки. Произведена оценка важности признаков с помощью библиотеки [LOFO](#LOFO) (по дефолтной модели). Так же по совету код-ревьюера анализ на мультиколлениарность был дополнен техникой [VIF](#VIF). Обнаружены колонки не несущие полезной нагрузки и содержащие утечку целевого признака

### 3. Подготовка данных и признаков - выполнено
Был [добавлен признак](#Добавление-фич) с длительностью действия контракта в днях. Выявленные на предыдущем шаге признаки (неинформативные, лики, мультиколлениарные) были удалены, [категориальные признаки](#Категориальные-колонки) закодированы и сформирована [отложенная выборка](#Разделение-данных-(отложенная-выборка)) с учетом баланса классов целевого признака
    
### 4. Подбор модели и гиперпараметров - выполнено
Для наглядности отображения полученных результатов была написана [функция](#Графики) построения графиков и вывода метрик. Протестированы следующие модели:
- [LogisticRegressionCV](#LogisticRegressionCV)
- [RandomForestClassifier](#RandomForestClassifier)
- [LGBMClassifier](#LGBMClassifier)
- [CatBoostClassifier](#CatBoostClassifier)
- [Полносвязная нейросеть](#Keras)

Для лучшей модели (**CatBoostClassifier**) [подобраны лучшие гиперпараметры](#GridSearch-CatBoostClassifier) и [улучшен результат](#CatBoostClassifier-с-подобранными-гиперпараметрами) до ROC-AUC=0.925. Дополнительно с помощью LOFO был отброшен еще один признак и [улучшено качество модели](#GridSearch-CatBoostClassifier-importance_features) до **ROC-AUC=0.931**

### 5. Анализ и интерпретация результатов - выполнено
Для лучшей модели полнота равняется 90.5% (порог=0.5). Также имеется "рейтинг" [полезности признаков](#GridSearch-CatBoostClassifier-importance_features), по которому можно показать бизнесу, что больше всего может влиять на факт ухода клиента, а что меньше.

Но это только предположение скромного Junior-датасатаниста...)) что-то рекомендовать бизнесу будет наш дорогой и уважаемый тимлид)))

~Охапка дров~ Собственно отчет готов :)